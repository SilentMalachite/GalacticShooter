# ギャラガ風シューティングゲーム

HTML5 Canvas と vanilla JavaScript で作られたクラシックなアーケードスタイルのシューティングゲームです。8-bit サウンドエフェクトと背景音楽を搭載し、デスクトップアプリケーションとしても動作します。

![ゲームスクリーンショット](./generated-icon.png)

## 🎮 ゲームの特徴

- **クラシックなアーケードゲームプレイ** - 懐かしのギャラガスタイルの戦闘システム
- **直感的な操作** - 矢印キーまたはWASDで移動、スペースキーで射撃
- **7種類の多彩な敵キャラクター** - 基本型、高速型、偵察型、重装型、爆撃型、狙撃型、ボス型
- **高度な敵AI システム** - ジグザグ移動、シールド展開、狙い撃ち、エリア爆撃、誘導ミサイル
- **美しいビジュアルエフェクト** - 敵タイプ別の固有デザインと爆発パーティクルエフェクト
- **本格的な敵の動き** - ギャラガらしい曲線的な侵入パターンと戦術的攻撃行動
- **8-bit サウンドシステム** - Web Audio API による本格的なレトロサウンド
- **プログレッシブな難易度** - レベルに応じた敵の種類と配置の動的調整
- **スコアと残機システム** - 敵タイプ別の詳細スコアリング
- **Electronデスクトップアプリ対応** - ローカルアプリケーションとして実行可能

## 🚀 プレイ方法

### 操作方法
- **移動**: 矢印キー または WASD
- **射撃**: スペースキー
- **音声切り替え**: Mキー
- **リスタート**: Rキー（ゲームオーバー時）

### ゲームルール
1. スタートボタンを押してゲーム開始
2. 自機を操作して敵を全て撃破
3. 敵の弾や敵機本体に当たると残機が減少
4. 残機が0になるとゲームオーバー
5. 全ての敵を倒すと次のレベルに進行

## 🛠️ 技術仕様

- **HTML5 Canvas** - ゲーム描画
- **Vanilla JavaScript** - ゲームロジック
- **Web Audio API** - 8-bit スタイルのサウンド生成
- **CSS3** - スタイリングとレスポンシブデザイン
- **Electron** - デスクトップアプリケーション化
- **ES6+** - モダンなJavaScript機能を活用

## 📁 ファイル構成

```
├── galaga-game.html       # メインのHTMLファイル
├── game.js               # ゲームロジック（JavaScript）
├── game.css              # スタイルシート
├── electron-main.js      # Electronメインプロセス
├── electron-package.json # Electron用設定ファイル
├── start-electron.sh     # Linux/Mac用起動スクリプト
├── start-electron.bat    # Windows用起動スクリプト
├── generated-icon.png    # アプリケーションアイコン
└── README.md             # このファイル
```

## 🎯 ゲームシステム詳細

### 敵の種類と特徴

#### 基本タイプ
- **基本型（緑）**: 標準的な敵、25ポイント
  - 通常の射撃パターン
  - バランスの取れた体力と速度

#### 高速タイプ
- **高速型（マゼンタ）**: 素早く動く敵、50ポイント
  - 2連射弾を発射
  - 高速な移動と攻撃

- **偵察型（青）**: ダイヤモンド型の敵、40ポイント
  - ジグザグ移動パターン
  - 高速急降下攻撃

#### 重装タイプ
- **重装型（オレンジ）**: 装甲が厚い敵、100ポイント
  - シールド展開機能（3秒間無敵）
  - 大型の重弾を発射
  - 体力2で撃破に時間がかかる

#### 特殊攻撃タイプ
- **爆撃型（オレンジ）**: 爆弾投下する敵、75ポイント
  - エリア爆撃攻撃（爆発半径40ピクセル）
  - 3方向散弾射撃

- **狙撃型（紫）**: 精密射撃する敵、80ポイント
  - 1.5秒の照準後に狙い撃ち
  - 高速で正確な弾丸

#### ボスタイプ
- **ボス型（赤）**: 最強の敵、200ポイント
  - 体力3の多段階攻撃
  - 5方向拡散弾と誘導ミサイル
  - 複雑な攻撃パターン

### 敵の行動パターン
- **侵入フェーズ**: 敵タイプに応じた曲線的な登場パターン
- **編隊フェーズ**: タイプ別の固有移動（浮遊、ジグザグ、安定移動）
- **攻撃フェーズ**: プレイヤーに向かった急降下攻撃
- **特殊フェーズ**: 狙撃、爆撃、ボス戦用の特別な攻撃モード

### オーディオシステム
- **動的背景音楽**: レベルに応じて変化する4つの8-bitメロディーパターン
- **三層音楽構成**: メロディー、ベース、ハーモニーによる豊かな音響
- **包括的効果音**: 15種類以上の敵・武器・UI専用サウンド
- **敵タイプ別音響**: 狙撃チャージ、爆弾投下、シールド展開、誘導ロック音
- **環境音**: 爆発、衝撃、メニュー操作の詳細サウンドフィードバック
- **音声制御**: Mキーでミュート/アンミュート切り替え

### ビジュアルエフェクト
- 星空の背景アニメーション
- パーティクルシステムによる爆発エフェクト
- 敵タイプ別の固有ビジュアルデザイン
- 弾丸タイプ別の視覚効果（パルス、回転、軌跡）
- 被ダメージ時の点滅エフェクト
- シールド展開とエイミングライン表示
- レトロなネオンスタイルのUI

## 🚀 起動方法

### Electronデスクトップアプリとして実行（推奨）

#### Windows:
```cmd
start-electron.bat
```

#### Linux/Mac:
```bash
./start-electron.sh
```

#### npmスクリプトでの起動:
```bash
npm run electron          # 本番相当
npm run electron:dev      # 開発モード（DevTools 有効）
```

### Webブラウザでの実行

#### 開発環境での実行
```bash
# 依存関係のインストール
npm install

# 開発サーバー起動
npm run dev
```

ブラウザで以下にアクセスできます：
- `http://localhost:5000/`（React UI トップ）
- `http://localhost:5000/galaga`（ゲームランディング → `galaga-game.html`へリダイレクト）
- `http://localhost:5000/galaga-game.html`（スタンドアロンHTML版）
- `http://localhost:5000/embed/galaga`（アプリ内埋め込みページ・iframeでゲームを表示）

API ヘルスチェック: `http://localhost:5000/api/health`

#### 直接実行
HTMLファイルを直接ブラウザで開くことも可能です。

### Electronアプリのビルド

実行可能ファイルを作成する場合：

```bash
# 依存インストール
npm install

# ルートpackage.jsonの設定を使ってビルド
npm run electron:build

# 直接コマンドで実行したい場合（同等）
npx electron-builder --publish=never
```

- 生成物は `electron-dist/` に出力されます（macOSで`.app`、WindowsでNSIS、LinuxでAppImageなど）。
- コード署名/公証は未設定です。配布する場合は各OSの証明書設定をご準備ください。
- ビルド設定はルート`package.json`の`build`フィールドを使用します（`electron-package.json`は互換目的で残置）。

### 開発ユーティリティ（Lint/Format/型チェック）

```bash
# Lint（ESLint v9 フラット設定）
npm run lint

# フォーマット（Prettier）
npm run format

# TypeScript 型チェック
npm run check
```

- ルール補足：未使用変数はエラー（ただし`_`で始まる名前は許容）。`switch` のフォールスルーは禁止。

## 🧪 CI（GitHub Actions）

本リポジトリにはCIワークフロー（`.github/workflows/ci.yml`）が含まれ、以下を検証します：

- 依存インストール（Node 20.x）
- Lint（ESLint v9 フラット設定）
- TypeScript 型チェック
- Prettier チェック
- ビルド（web + server）

Electronパッケージの生成はCIではデフォルトでスキップしています（OS依存のため）。必要に応じてOS別のワークフローを追加してください。

## 🤝 開発・貢献

開発への参加方法やPRチェックリストは `CONTRIBUTING.md` を参照してください。セキュリティ連絡や依存監査の方針は `SECURITY.md` を参照してください。

## 🎨 カスタマイズ

### ゲーム設定の変更
`game.js` ファイル内の `gameConfig` オブジェクトで以下を調整できます：

```javascript
const gameConfig = {
    width: 800,      // キャンバス幅
    height: 600,     // キャンバス高
    lives: 3,        // 初期残機数
    // その他の設定...
};
```

### 敵設定のカスタマイズ
各敵タイプの特性を調整：

```javascript
// 敵タイプ別の設定例
case 'heavy':
    this.health = 2;           // 体力
    this.shieldActive = false; // シールド機能
    this.color = '#ffaa00';    // 色
    break;

case 'sniper':
    this.aimingTime = 1500;    // 照準時間（ミリ秒）
    this.attackChance = 0.3;   // 攻撃確率
    break;
```

### プレイヤー設定
```javascript
const player = {
    speed: 5,           // 移動速度
    shootCooldown: 0,   // 射撃間隔
    invulnerable: 0,    // 無敵時間
    // その他の設定...
};
```

### 弾丸システム設定
```javascript
// 弾丸タイプ別の設定例
shootHoming() {
    const bullet = {
        homingStrength: 0.05,  // 誘導強度
        speed: 2,              // 基本速度
        type: 'homing'         // 弾丸タイプ
    };
}
```

### オーディオ設定
`AudioManager` クラス内で音量やサウンドエフェクトを調整できます：

```javascript
// 音量調整
this.musicGain.gain.value = 0.3;  // 背景音楽の音量
this.masterGain.gain.value = 1.0; // マスター音量

// サウンドエフェクトの周波数調整
this.createSound(800, 0.1, 'square', 0.05);  // 射撃音

// 背景音楽パターンの選択
getMusicPattern() {
    const level = gameConfig.level || 1;
    const patternIndex = (level - 1) % 4;  // 4つのパターンを循環
    return patterns[patternIndex];
}

// 敵専用サウンドの調整例
playSniperCharge() {
    let freq = 400;
    for (let i = 0; i < 15; i++) {
        setTimeout(() => {
            this.createSound(freq + (i * 50), 0.1, 'triangle', 0.03);
        }, i * 100);
    }
}
```

## 📦 システム要件

### デスクトップアプリケーション
- **Node.js** 16.0.0 以上
- **RAM** 最小 512MB
- **ストレージ** 約 200MB
- **対応OS**: Windows 10+、macOS 10.14+、Ubuntu 18.04+

### Webブラウザ
- **Chrome** 88+
- **Firefox** 85+
- **Safari** 14+
- **Edge** 88+

## 🔧 実装済み機能

- ✅ 動的8-bit サウンドシステム（15+効果音、4パターン背景音楽）
- ✅ Electronデスクトップアプリケーション
- ✅ レスポンシブデザイン
- ✅ パーティクルエフェクト
- ✅ 7種類の敵タイプと高度なAI行動パターン
- ✅ タイプ別射撃システム（通常弾、拡散弾、誘導弾、爆弾）
- ✅ エリア爆撃とシールド展開システム
- ✅ 敵専用音響フィードバック（チャージ、爆撃、シールド音）
- ✅ プログレッシブ難易度調整
- ✅ 敵タイプ別スコアリングシステム
- ✅ ゲームデータの永続化（スコア、レベル）

## 🔧 今後の拡張予定

- [ ] ハイスコア保存機能
- [ ] パワーアップアイテム（連射、拡散弾、シールド）
- [ ] ボーナスステージ
- [ ] ステージ選択機能
- [ ] マルチプレイヤー対応

## 🐛 トラブルシューティング

### よくある問題

**音が出ない場合:**
- ブラウザの音声設定を確認してください
- Mキーでミュートが有効になっていないか確認してください
- 最新のブラウザを使用してください
- ブラウザの自動再生ポリシーによりスタートボタンクリック後に音声が開始されます
- Web Audio APIが無効な場合はブラウザ設定を確認してください

**Electronアプリが起動しない場合:**
- Node.jsが正しくインストールされているか確認してください
- `npm install electron` を実行してElectronをインストールしてください
- ファイルの権限を確認してください（Linux/Mac）

**ゲームが重い場合:**
- ブラウザの他のタブを閉じてください
- ハードウェアアクセラレーションを有効にしてください

## 📝 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 🤝 貢献

プルリクエストやイシューの報告を歓迎します。ゲームの改善にご協力ください！

### 開発への参加方法
1. このリポジトリをフォーク
2. 新しいブランチを作成 (`git checkout -b feature/amazing-feature`)
3. 変更をコミット (`git commit -m 'Add some amazing feature'`)
4. ブランチにプッシュ (`git push origin feature/amazing-feature`)
5. プルリクエストを作成

---

**注意**: このゲームはクラシックなギャラガへのオマージュとして作成されており、教育目的でのプロジェクトです。
